FROM python:3.11-slim

# 设置环境变量
ENV PYTHONUNBUFFERED=1 \
    PYTHONDONTWRITEBYTECODE=1

WORKDIR /app

# 复制本地wheel文件
COPY wheels/ ./wheels/

# 离线安装Python依赖
RUN pip install --no-index --find-links wheels/ \
    Flask==3.0.0 \
    Flask-CORS==4.0.0 \
    chardet==5.2.0 \
    requests==2.31.0

# 复制应用代码
COPY backend/ ./backend/
COPY start.py ./
COPY frontend-vue/dist/ ./frontend-vue/dist/

# 暴露端口
EXPOSE 15000

# 启动命令
CMD ["python", "backend/app.py"] 